<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
</head>
<style>
  body {
    font-family: sans-serif;
  }
</style>
<body>
  <h1>Node Navigator + Elasticsearch </h1>
<div id="nodeNavigator"></div>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="javascripts/NodeNavigator/NodeNavigator.js"></script>

<script>

  var catColumns = [
    //"MUNICIPIO_ENVIO",
    "ID_PREDIO",
    "DESTINO",
    "ESTRATO",
    "TIPO_SOPORTE",
    "ID_SOPORTE_TRIBUTARIO",
    "ID_UNICO_CONTRIBUYENTE",
    "NUMERO_SOPORTE_TRIBUTARIO",
    "LOTE",
    //"ESTADO",
    //"MARCA",
    "PROGRAMA_GESTION",
    "FUENTE_DIR"
  ];
  var seqColumns = [
    // "FECHA_LIMITE_1",
    // "FECHA_LIMITE_2",
    // "FECHA_LIMITE_3",
    // //"FECHA_ESTADO",
    // "FECHA_REG",
    // "AJUSTE_TARIFA",
    // "AREA_TERRENO",
    // "TARIFA_PLENA",
    // "IMPUESTO_CARGO",
    // "AUTOAVALUO",
    // "AREA_CONSTRUIDA",
    // "PORCENTAJE_EXENCION",
    // "AJUSTE_EQUIDAD_3",
    // "AJUSTE_EQUIDAD_2",
    // "AJUSTE_EQUIDAD_1",
    // "SALDO_CARGO_1",
    // "SALDO_CARGO_2",
    // "SALDO_CARGO_3",
    // "IMPUESTO_AJUSTADO_3",
    // "IMPUESTO_AJUSTADO_2",
    // "IMPUESTO_AJUSTADO_1",
    // "TOTAL_PAGAR_3",
    // "TOTAL_PAGAR_2",
    // "TOTAL_PAGAR_1",
    // "VALOR_DESCUENTO_3",
    // "VALOR_DESCUENTO_2",
    // "VALOR_DESCUENTO_1",
    // "VALOR_SANCION_2",
    // "VALOR_SANCION_1",
    // "VALOR_SANCION_3",
    // "VALOR_TOTAL_CON_PAGO_VOL_3",
    // "VALOR_TOTAL_CON_PAGO_VOL_2",
    // "VALOR_TOTAL_CON_PAGO_VOL_1",
    // "VALOR_PAGO_VOLUNTARIO_3",
    // "VALOR_PAGO_VOLUNTARIO_2",
    // "VALOR_PAGO_VOLUNTARIO_1",
    // "VALOR_PAGAR_1",
    // "VALOR_PAGAR_2",
    // "VALOR_PAGAR_3"
  ];

  var nn = new NodeNavigator("#nodeNavigator", 600).id("i");

  catColumns.forEach((c) => nn.addCategoricalAttrib(c));
  seqColumns.forEach((c) => nn.addSequentialAttrib(c));

  var data =[];
  var i =0;
  // Papa.parse("./head.csv", {
  //   // download: true,
  //   delimiter:";",
  //   header: true,
  //   // worker: true,
  //   download:true,
  //   step: function(row) {
  //       // console.log("Row:", row.data);
  //       row.data[0].i= i++;
  //       data.push(row.data[0]);
  //       // if (i%100000===0) {
  //       //     console.log("redraw 100k");
  //       //     nn.data(data);
  //       // }
  //   },
  //   complete: function() {
  //       console.log("All done!");
  //       nn.data(data);
  //   }
  // });

  d3.csv("predialsampler/", type, function (err, data) {
    if (err) throw err;
    console.log(data.length);
    // data = d3.dsvFormat(";").formatRows(data);
    data.forEach((d,i) => d.i = i);

    nn.data(data);
  });

  //26/01/2016 04:21:05 a.m.
  var fmt = d3.timeParse("%d-%m-%Y %H:%M:%S %p");

  function type(row) {/*
    var split = row["car-id"].split("-");
    row.Timestamp = fmt(row.Timestamp);
    row.hours = row.Timestamp.getHours();
    row.dayNight = row.hour < 6 || row.hour>18 ? "night": "day";
    row.dayOfTheWeek = row.Timestamp.getDay();
    row.minutes = row.Timestamp.getMinutes();
    row.seconds = row.Timestamp.getSeconds();
    row.year = row.Timestamp.getFullYear();
    row.month = row.Timestamp.getMonth();
    row.day = row.Timestamp.getDate();
    row.carIdPart1 = +split[0];
    row.carIdPart2 = +split[1];*/
    return row;
  }
</script>
</body>
</html>